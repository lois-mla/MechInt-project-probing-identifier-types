import matplotlib.pyplot as plt

layers = list(range(32))

train_acc = [
    0.44375,
    0.7229166666666667,
    0.69625,
    0.8604166666666667,
    0.85375,
    0.8633333333333333,
    0.91625,
    0.9183333333333333,
    0.9295833333333333,
    0.93,
    0.9170833333333334,
    0.9345833333333333,
    0.9525,
    0.9504166666666667,
    0.95625,
    0.9683333333333334,
    0.9758333333333333,
    0.9804166666666667,
    0.9679166666666666,
    0.9733333333333334,
    0.9770833333333333,
    0.9633333333333334,
    0.98,
    0.9854166666666667,
    0.9879166666666667,
    0.98125,
    0.9879166666666667,
    0.98875,
    0.9866666666666667,
    0.9891666666666666,
    0.9820833333333333,
    0.9708333333333333,
]

test_acc = [
    0.45,
    0.7283333333333334,
    0.7333333333333333,
    0.86,
    0.8416666666666667,
    0.8466666666666667,
    0.8966666666666666,
    0.9133333333333333,
    0.9066666666666666,
    0.8983333333333333,
    0.895,
    0.9083333333333333,
    0.925,
    0.9183333333333333,
    0.9183333333333333,
    0.925,
    0.9266666666666666,
    0.925,
    0.9183333333333333,
    0.9216666666666666,
    0.9283333333333333,
    0.9316666666666666,
    0.9116666666666666,
    0.945,
    0.95,
    0.9316666666666666,
    0.94,
    0.9333333333333333,
    0.9466666666666667,
    0.935,
    0.9316666666666666,
    0.9266666666666666,
]

train_accs = [
    0.33541666666666664,
    0.5029166666666667,
    0.7525,
    0.7570833333333333,
    0.84,
    0.8679166666666667,
    0.8691666666666666,
    0.9229166666666667,
    0.935,
    0.9175,
    0.93375,
    0.9516666666666667,
    0.95125,
    0.9583333333333334,
    0.97375,
    0.9716666666666667,
    0.975,
    0.9679166666666666,
    0.9708333333333333,
    0.9779166666666667,
    0.96875,
    0.97625,
    0.97875,
    0.9391666666666667,
    0.9770833333333333,
    0.98125,
    0.9825,
    0.9758333333333333,
    0.9295833333333333,
    0.9904166666666666,
    0.9933333333333333,
    0.9895833333333334,
]

test_accs = [
    0.325,
    0.5016666666666667,
    0.7916666666666666,
    0.785,
    0.8366666666666667,
    0.8516666666666667,
    0.8533333333333334,
    0.9166666666666666,
    0.9266666666666666,
    0.9083333333333333,
    0.9016666666666666,
    0.915,
    0.925,
    0.9166666666666666,
    0.9266666666666666,
    0.935,
    0.9283333333333333,
    0.9383333333333334,
    0.9316666666666666,
    0.9216666666666666,
    0.9383333333333334,
    0.9483333333333334,
    0.9416666666666667,
    0.9166666666666666,
    0.945,
    0.9466666666666667,
    0.945,
    0.9383333333333334,
    0.9083333333333333,
    0.9533333333333334,
    0.95,
    0.945,
]


plt.figure()
plt.plot(layers, train_accs, label="Train accuracy")
plt.plot(layers, test_accs, label="Test accuracy")
plt.xlabel("Layer")
plt.ylabel("Accuracy")
plt.title("Probe accuracy vs layer resid_pre")
plt.legend()
plt.grid(True)
plt.show()


